# Standard access log (normal traffic only when $log_access=1)
log_format main '$remote_addr - $remote_user [$time_local] "$request_method $request_uri $server_protocol" '
    '$status $body_bytes_sent "$http_referer" "$http_user_agent" '
    'rt=$request_time uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time"';

# Security channel: suspicious traffic only (rsyslog â†’ /mirror/security)
log_format security_analysis
    'time=$time_iso8601 '
    'remote_addr=$remote_addr '
    'method=$request_method '
    'uri=$request_uri '
    'redacted_args=$redacted_query '
    'status=$status '
    'violation_reason=$violation_reason '
    'http_user_agent="$http_user_agent" '
    'referer="$http_referer" '
    'host=$host '
    'request_time=$request_time '
    'bytes_sent=$bytes_sent';
