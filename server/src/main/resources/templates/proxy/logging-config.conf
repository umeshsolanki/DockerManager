# Normal access: status 100-399 and no security violation (buffered to reduce I/O)
# Values from settings: logBufferSizeKb, logFlushIntervalSeconds; omit buffer/flush when logBufferingEnabled=false
access_log /usr/local/openresty/nginx/logs/access.log main if=$log_access buffer=${logBufferSizeKb}k flush=${logFlushIntervalSeconds}s;

# Security channel: status >= 400 or explicit violation → rsyslog → /mirror/security
# Buffered to avoid blocking; values from settings (logBufferSizeKb, logFlushIntervalSeconds)
access_log /usr/local/openresty/nginx/logs/security.log security_analysis if=$log_security buffer=${logBufferSizeKb}k flush=${logFlushIntervalSeconds}s;
