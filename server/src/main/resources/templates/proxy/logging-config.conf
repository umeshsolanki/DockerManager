# Normal access: status 100-399 and no security violation (buffered to reduce I/O)
access_log /usr/local/openresty/nginx/logs/access.log main if=$log_access buffer=32k flush=5s;

# Security channel: status >= 400 or explicit violation → rsyslog → /mirror/security
# Buffered to avoid blocking; increase buffer if security log volume is very high
access_log /usr/local/openresty/nginx/logs/security.log security_analysis if=$log_security buffer=8k flush=5s;
